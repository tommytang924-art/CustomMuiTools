{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tommytang/Documents/myproject/muitools/src/lib/authUtils.ts"],"sourcesContent":["import { NextAuthOptions } from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport { randomBytes, randomUUID } from \"crypto\";\r\n\r\ntype LoginResponse = {\r\n    code: number;\r\n    msg: string;\r\n    result: LoginResponseResult;\r\n};\r\nexport type LoginResponseResult = {\r\n    sysuserId: string;\r\n    sysuserName: string;\r\n};\r\n\r\n// Encryption function\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n    providers: [\r\n        CredentialsProvider({\r\n            name: \"Credentials\",\r\n            credentials: {\r\n                sysuserId: { label: \"Username\", type: \"text\" },\r\n                sysuserPwd: { label: \"Password\", type: \"password\" },\r\n            },\r\n            authorize: async (credentials) => {\r\n                const { sysuserId, sysuserPwd } = credentials as {\r\n                    sysuserId: string;\r\n                    sysuserPwd: string;\r\n                };\r\n\r\n                if (!sysuserId || !sysuserPwd) {\r\n                    console.error(\"Missing sysuserId or sysuserPwd\");\r\n                    return null;\r\n                }\r\n\r\n                try {\r\n                    // **Suppose here is the API for login\r\n                    //   const rawResponse = await fetch(\r\n                    //     `${process.env.NEXT_PUBLIC_API_URL}/login`, // login API\r\n                    //     {\r\n                    //       method: \"POST\",\r\n                    //       headers: {\r\n                    //         Authorization:\r\n                    //           \"Basic \" +\r\n                    //           Buffer.from(\r\n                    //             `${process.env.API_USERNAME2}:${process.env.API_PASSWORD2}`,\r\n                    //             \"binary\"\r\n                    //           ).toString(\"base64\"),\r\n                    //         \"Content-Type\": \"application/json\",\r\n                    //       },\r\n                    //       body: JSON.stringify({\r\n                    //         sysuserId,\r\n                    //         sysuserPwd,\r\n                    //       }),\r\n                    //     }\r\n                    //   );\r\n\r\n                    //   const response: LoginResponse = await rawResponse.json();\r\n                    //   if (response.code === 0) {\r\n                    if (sysuserId === \"admin\" && sysuserPwd === \"admin\") {\r\n                        return {\r\n                            id: `${credentials?.sysuserId}`,\r\n                            sysuserId: credentials?.sysuserId,\r\n                            sysuserName: \"admin\",\r\n                        };\r\n                    }\r\n                    else{\r\n                        throw new Error(\"Invalid authentication\");\r\n                    }\r\n\r\n                } catch (error) {\r\n                    console.log(\"next Auth error\", error);\r\n                    return null;\r\n                }\r\n            },\r\n        }),\r\n    ],\r\n    callbacks: {\r\n        async jwt({ token, user }) {\r\n            if (user) {\r\n                token.sysuserId = user.sysuserId;\r\n                token.sysuserName = user.sysuserName;\r\n            }\r\n            return token;\r\n        },\r\n        async session({ session, token }) {\r\n            if (token) {\r\n                session.user.sysuserId = token.sysuserId as string;\r\n                session.user.sysuserName = token.sysuserName as string;\r\n            }\r\n            return session;\r\n        },\r\n        async signIn({ user }) {\r\n            return true;\r\n        },\r\n    },\r\n    events: {\r\n        async signOut() { },\r\n    },\r\n    session: {\r\n        strategy: \"jwt\",\r\n        maxAge: 60 * 60, // 1 day in seconds\r\n        updateAge: 0,   // Extend session every 6 hours of activity\r\n        generateSessionToken: () => randomUUID?.() ?? randomBytes(32).toString(\"hex\"),\r\n    },\r\n    jwt: {\r\n        maxAge: 60 * 60\r\n    },\r\n\r\n    pages: {\r\n        signIn: `${process.env.NEXT_PUBLIC_BASEPATH ? `/${process.env.NEXT_PUBLIC_BASEPATH}` : ''}/login`,\r\n        signOut: `${process.env.NEXT_PUBLIC_BASEPATH ? `/${process.env.NEXT_PUBLIC_BASEPATH}` : ''}/login`,\r\n        error: `${process.env.NEXT_PUBLIC_BASEPATH ? `/${process.env.NEXT_PUBLIC_BASEPATH}` : ''}/error`,\r\n    },\r\n    secret: process.env.NEXTAUTH_SECRET,\r\n};\r\n\r\nexport default authOptions;\r\n"],"names":[],"mappings":";;;;;;AACA;AACA;;;AAcO,MAAM,cAA+B;IACxC,WAAW;QACP,IAAA,qKAAmB,EAAC;YAChB,MAAM;YACN,aAAa;gBACT,WAAW;oBAAE,OAAO;oBAAY,MAAM;gBAAO;gBAC7C,YAAY;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YACtD;YACA,WAAW,OAAO;gBACd,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG;gBAKlC,IAAI,CAAC,aAAa,CAAC,YAAY;oBAC3B,QAAQ,KAAK,CAAC;oBACd,OAAO;gBACX;gBAEA,IAAI;oBACA,sCAAsC;oBACtC,qCAAqC;oBACrC,+DAA+D;oBAC/D,QAAQ;oBACR,wBAAwB;oBACxB,mBAAmB;oBACnB,yBAAyB;oBACzB,uBAAuB;oBACvB,yBAAyB;oBACzB,2EAA2E;oBAC3E,uBAAuB;oBACvB,kCAAkC;oBAClC,8CAA8C;oBAC9C,WAAW;oBACX,+BAA+B;oBAC/B,qBAAqB;oBACrB,sBAAsB;oBACtB,YAAY;oBACZ,QAAQ;oBACR,OAAO;oBAEP,8DAA8D;oBAC9D,+BAA+B;oBAC/B,IAAI,cAAc,WAAW,eAAe,SAAS;wBACjD,OAAO;4BACH,IAAI,GAAG,aAAa,WAAW;4BAC/B,WAAW,aAAa;4BACxB,aAAa;wBACjB;oBACJ,OACI;wBACA,MAAM,IAAI,MAAM;oBACpB;gBAEJ,EAAE,OAAO,OAAO;oBACZ,QAAQ,GAAG,CAAC,mBAAmB;oBAC/B,OAAO;gBACX;YACJ;QACJ;KACH;IACD,WAAW;QACP,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,SAAS,GAAG,KAAK,SAAS;gBAChC,MAAM,WAAW,GAAG,KAAK,WAAW;YACxC;YACA,OAAO;QACX;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,OAAO;gBACP,QAAQ,IAAI,CAAC,SAAS,GAAG,MAAM,SAAS;gBACxC,QAAQ,IAAI,CAAC,WAAW,GAAG,MAAM,WAAW;YAChD;YACA,OAAO;QACX;QACA,MAAM,QAAO,EAAE,IAAI,EAAE;YACjB,OAAO;QACX;IACJ;IACA,QAAQ;QACJ,MAAM,YAAY;IACtB;IACA,SAAS;QACL,UAAU;QACV,QAAQ,KAAK;QACb,WAAW;QACX,sBAAsB,IAAM,mHAAU,QAAQ,IAAA,oHAAW,EAAC,IAAI,QAAQ,CAAC;IAC3E;IACA,KAAK;QACD,QAAQ,KAAK;IACjB;IAEA,OAAO;QACH,QAAQ,GAAG,uCAAmC,CAAC,CAAC,8CAAoC,GAAG,wBAAG,MAAM,CAAC;QACjG,SAAS,GAAG,uCAAmC,CAAC,CAAC,8CAAoC,GAAG,wBAAG,MAAM,CAAC;QAClG,OAAO,GAAG,uCAAmC,CAAC,CAAC,8CAAoC,GAAG,wBAAG,MAAM,CAAC;IACpG;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACvC;uCAEe"}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/tommytang/Documents/myproject/muitools/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\r\nimport authOptions from \"@/lib/authUtils\";\r\n\r\nconst handler = NextAuth(authOptions);\r\n\r\nexport { handler as GET, handler as POST };\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC,oIAAW"}}]
}